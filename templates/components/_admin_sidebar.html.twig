{% set route = app.request.attributes.get('_route') %}
<aside class="flex h-screen w-64 flex-col border-r bg-white px-4 py-6">

    {# Brand #}
    <a href="{{ path('app_home') }}" class="mb-8 flex items-center gap-3 px-2">
        <span class="flex h-9 w-9 items-center justify-center rounded-lg bg-indigo-600 text-white text-lg font-semibold">
            E
        </span>
        <span class="text-lg font-semibold tracking-tight text-slate-900">
            Eventra
        </span>
    </a>

    {# Navigation #}
    <nav class="space-y-1">
        <p class="px-3 text-xs font-semibold uppercase tracking-wide text-slate-400">
            Dashboard
        </p>

        <a href="{{ path('app_dashboard') }}"
           class="group flex items-center gap-3 rounded-lg px-3 py-2 text-sm font-medium
          {{ route == 'app_dashboard'
           ? 'bg-indigo-50 text-indigo-700'
           : 'text-slate-700 hover:bg-indigo-50 hover:text-indigo-700' }}">
            <span class="h-2 w-2 rounded-full bg-indigo-600 opacity-0 group-hover:opacity-100"></span>
            Overview
        </a>


        <a href="{{ path('app_dashboard_events') }}"
           class="group flex items-center gap-3 rounded-lg px-3 py-2 text-sm font-medium
          {{ route == 'app_dashboard_events'
           ? 'bg-indigo-50 text-indigo-700'
           : 'text-slate-700 hover:bg-indigo-50 hover:text-indigo-700' }}">
            <span class="h-2 w-2 rounded-full bg-indigo-600 opacity-0 group-hover:opacity-100"></span>
            Events
        </a>

        <a href="{{ path('app_dashboard_categories') }}"
           class="group flex items-center gap-3 rounded-lg px-3 py-2 text-sm font-medium
          {{ route == 'app_dashboard_categories'
           ? 'bg-indigo-50 text-indigo-700'
           : 'text-slate-700 hover:bg-indigo-50 hover:text-indigo-700' }}">
            <span class="h-2 w-2 rounded-full bg-indigo-600 opacity-0 group-hover:opacity-100"></span>
            Categories
        </a>
        {% if is_granted("ROLE_ADMIN") %}
        <a href="{{ path('app_dashboard_users') }}"
           class="group flex items-center gap-3 rounded-lg px-3 py-2 text-sm font-medium
          {{ route == 'app_dashboard_users'
           ? 'bg-indigo-50 text-indigo-700'
           : 'text-slate-700 hover:bg-indigo-50 hover:text-indigo-700' }}">
            <span class="h-2 w-2 rounded-full bg-indigo-600 opacity-0 group-hover:opacity-100"></span>
            Users
        </a>
        {% endif %}
    </nav>

    {# Secondary #}
    <div class="mt-auto pt-4">
        <div class="my-6 border-t"></div>

        <el-dropdown class="relative block">
            {# Trigger #}
            <button
                class="flex w-full items-center gap-3 rounded-xl px-3 py-2 hover:bg-slate-100 transition text-left focus:outline-none"
                aria-label="Open user menu"
            >
            <span class="inline-flex h-10 w-10 items-center justify-center rounded-full bg-indigo-600 text-sm font-semibold text-white">
                <img class="rounded-full border-indigo-600 border-2" src="{{ app.user.userprofile.avatarurl }}"  alt="Avatar"/>
            </span>

                <span class="flex-1 overflow-hidden">
                <span class="block truncate text-sm font-medium text-slate-900">
                    {{ app.user.userprofile.displayname ?? app.user.userIdentifier }}
                </span>
                <span class="block truncate text-xs text-slate-500">
                    {{ app.user.userIdentifier }}
                </span>
            </span>

                <svg class="h-4 w-4 text-slate-400" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.17l3.71-3.94a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd" />
                </svg>
            </button>

            {# Dropdown #}
            <el-menu
                anchor="top end"
                popover
                class="mb-2 w-56 origin-bottom-right divide-y divide-white/10 rounded-xl bg-gray-800 shadow-lg outline-1 -outline-offset-1 outline-white/10
                   transition data-closed:scale-95 data-closed:opacity-0 data-enter:duration-100 data-enter:ease-out
                   data-leave:duration-75 data-leave:ease-in"
            >
                <div class="px-4 py-3">
                    <p class="text-sm font-medium text-white">
                        {{ app.user.userprofile.displayname ?? app.user.userIdentifier }}
                    </p>
                    <p class="text-xs text-gray-400">
                        {{ app.user.userIdentifier }}
                    </p>
                </div>

                <div class="py-1">
                    <a href="{{ path('app_dashboard') }}"
                       class="block px-4 py-2 text-sm text-gray-300 hover:bg-white/5 hover:text-white">
                        Dashboard
                    </a>

                    <a href="{{ path('app_account') }}"
                       class="block px-4 py-2 text-sm text-gray-300 hover:bg-white/5 hover:text-white">
                        Profile
                    </a>

                    <a href="#"
                       class="block px-4 py-2 text-sm text-gray-300 hover:bg-white/5 hover:text-white">
                        Settings
                    </a>
                </div>

                <div class="py-1">
                    <a href="{{ path('app_home') }}"
                       class="block px-4 py-2 text-sm text-gray-300 hover:bg-white/5 hover:text-white">
                        Back to site
                    </a>

                    <a href="{{ path('app_logout') }}"
                       class="block px-4 py-2 text-sm text-red-400 hover:bg-white/5 hover:text-red-300">
                        Log out
                    </a>
                </div>
            </el-menu>
        </el-dropdown>
    </div>
</aside>
